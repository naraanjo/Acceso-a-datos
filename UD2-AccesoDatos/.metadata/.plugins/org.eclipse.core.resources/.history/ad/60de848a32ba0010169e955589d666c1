package Veterinario.vet;

import java.util.Scanner;

public class Libreria {
    private static Scanner scanner = new Scanner(System.in);
    
    public static String leerString(String mensaje) {
        System.out.print(mensaje);
        return scanner.nextLine().trim();
    }
    
    public static String leerStringOpcional(String mensaje) {
        System.out.print(mensaje);
        return scanner.nextLine().trim();
    }
    
    public static int leerEntero(String mensaje) {
        int numero = 0;
        boolean valido;
        do {
            valido = true;
            System.out.print(mensaje);
            String input = scanner.nextLine().trim();
            try {
                numero = Integer.parseInt(input);
            } catch (NumberFormatException e) {
                System.out.println("Error: Por favor ingrese un número entero válido.");
                valido = false;
            }
        } while (!valido);
        return numero;
    }

    public static int leerEnteroPositivo(String mensaje) {
        int numero = 0;
        boolean valido;
        do {
            valido = true;
            System.out.print(mensaje);
            String input = scanner.nextLine().trim();
            try {
                numero = Integer.parseInt(input);
                if (numero <= 0) {
                    System.out.println("Error: El número debe ser mayor que cero.");
                    valido = false;
                }
            } catch (NumberFormatException e) {
                System.out.println("Error: Por favor ingrese un número entero válido.");
                valido = false;
            }
        } while (!valido);
        return numero;
    }

    public static int leerEnteroEnRango(String mensaje, int min, int max) {
        int numero = 0;
        boolean valido;
        do {
            valido = true;
            System.out.print(mensaje);
            String input = scanner.nextLine().trim();
            try {
                numero = Integer.parseInt(input);
                if (numero < min || numero > max) {
                    System.out.println("Error: El número debe estar entre " + min + " y " + max + ".");
                    valido = false;
                }
            } catch (NumberFormatException e) {
                System.out.println("Error: Por favor ingrese un número entero válido.");
                valido = false;
            }
        } while (!valido);
        return numero;
    }

    public static double leerDouble(String mensaje) {
        double numero = 0.0;
        boolean valido;
        do {
            valido = true;
            System.out.print(mensaje);
            String input = scanner.nextLine().trim();
            try {
                numero = Double.parseDouble(input);
            } catch (NumberFormatException e) {
                System.out.println("Error: Por favor ingrese un número decimal válido.");
                valido = false;
            }
        } while (!valido);
        return numero;
    }

    public static double leerDoubleNoNegativo(String mensaje) {
        double numero = 0.0;
        boolean valido;
        do {
            valido = true;
            System.out.print(mensaje);
            String input = scanner.nextLine().trim();
            try {
                numero = Double.parseDouble(input);
                if (numero < 0) {
                    System.out.println("Error: El número no puede ser negativo.");
                    valido = false;
                }
            } catch (NumberFormatException e) {
                System.out.println("Error: Por favor ingrese un número decimal válido.");
                valido = false;
            }
        } while (!valido);
        return numero;
    }

    public static double leerDoubleEnRango(String mensaje, double min, double max) {
        double numero = 0.0;
        boolean valido;
        do {
            valido = true;
            System.out.print(mensaje);
            String input = scanner.nextLine().trim();
            try {
                numero = Double.parseDouble(input);
                if (numero < min || numero > max) {
                    System.out.println("Error: El número debe estar entre " + min + " y " + max + ".");
                    valido = false;
                }
            } catch (NumberFormatException e) {
                System.out.println("Error: Por favor ingrese un número decimal válido.");
                valido = false;
            }
        } while (!valido);
        return numero;
    }

    public static int parsearEntero(String texto) {
        try {
            return Integer.parseInt(texto.trim());
        } catch (NumberFormatException e) {
            System.out.println("Error: No se pudo convertir '" + texto + "' a número entero.");
            return 0;
        }
    }

    public static double parsearDouble(String texto) {
        try {
            return Double.parseDouble(texto.trim());
        } catch (NumberFormatException e) {
            System.out.println("Error: No se pudo convertir '" + texto + "' a número decimal.");
            return 0.0;
        }
    }

    public static boolean leerSiNo(String mensaje) {
        String respuesta;
        boolean valido;
        do {
            valido = true;
            respuesta = leerString(mensaje).toLowerCase();
            if (respuesta.equals("s") || respuesta.equals("si") || respuesta.equals("sí") || respuesta.equals("y") || respuesta.equals("yes")) {
                return true;
            } else if (respuesta.equals("n") || respuesta.equals("no")) {
                return false;
            } else {
                System.out.println("Error: Por favor ingrese 's' para sí o 'n' para no.");
                valido = false;
            }
        } while (!valido);
        return false; // nunca se llega, pero necesario por sintaxis
    }



    public static Double leerDoubleOpcional(String mensaje) {
        Double numero = null;
        boolean valido;
        do {
            valido = true;
            System.out.print(mensaje);
            String input = scanner.nextLine().trim();
            
            if (input.isEmpty()) {
                return null;
            }
            
            try {
                numero = Double.parseDouble(input);
            } catch (NumberFormatException e) {
                System.out.println("Error: Por favor ingrese un número decimal válido o deje vacío para no cambiar.");
                valido = false;
            }
        } while (!valido);
        return numero;
    }

    public static String leerStringNoVacio(String mensaje) {
        String input;
        do {
            System.out.print(mensaje);
            input = scanner.nextLine().trim();
            if (input.isEmpty()) {
                System.out.println("Error: Este campo no puede estar vacío.");
            }
        } while (input.isEmpty());
        return input;
    }
}
